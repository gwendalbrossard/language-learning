model Profile {
  id                    String                @id @default(cuid())
  email                 String
  name                  String
  avatar                String?
  timezone              String /// IANA timezone identifier (e.g., "America/New_York", "Europe/London", "Asia/Tokyo"). All our dates are stored in UTC so we'll need to convert to the user's timezone when needed.
  nativeLanguage        String                @default("en-US") /// BCP 47 language tag (ISO 639 + ISO 3166), e.g. "en-US", "en-GB", "fr-CA" // TODO: Remove default value when we have a way to set the native language.
  learningLanguage      String                @default("fr-FR") /// BCP 47 language tag (ISO 639 + ISO 3166), e.g. "en-US", "es-MX", "ja-JP" // TODO: Remove default value when we have a way to set the learning language.
  learningLanguageLevel LearningLanguageLevel @default(INTERMEDIATE) /// TODO: Remove default value when we have a way to set the learning language level.

  tokensInputText        Int @default(0)
  tokensInputTextCached  Int @default(0)
  tokensInputAudio       Int @default(0)
  tokensInputAudioCached Int @default(0)
  tokensOutputText       Int @default(0)
  tokensOutputAudio      Int @default(0)

  secondsSpoken       Int     @default(0)
  secondsListening    Int     @default(0)
  secondsInLessons    Int     @default(0)
  secondsInRoleplays  Int     @default(0)
  wordsSpoken         Int     @default(0)
  lessonsDone         Int     @default(0)
  roleplaysDone       Int     @default(0)
  vocabularyLearned   Int     @default(0)
  daysOfPractice      Int     @default(0)
  currentStreak       Int     @default(0)
  longestStreak       Int     @default(0)
  completedOnboarding Boolean @default(false)

  metadata           Json  @default("{}")
  revenueCatCustomer Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId String @unique
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  lastStreakDayId String?
  lastStreakDay   StreakDay? @relation(name: "LastStreakDay", fields: [lastStreakDayId], references: [id])

  members            Member[]
  invitations        Invitation[]
  streakDays         StreakDay[]
  roleplays          Roleplay[]
  roleplaySessions   RoleplaySession[]
  roleplayCategories RoleplayCategory[]
  lessons            Lesson[]
  lessonSessions     LessonSession[]
  lessonCategories   LessonCategory[]

  @@map("profile")
}

enum LearningLanguageLevel {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  PROFICIENT
  FLUENT
}
